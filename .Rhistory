cite(mixomics)
cite("mixomics")
?mixOmics
knitr::opts_chunk$set(echo = TRUE)
cran <- c("ggplot2",
"ggpubr",
NULL)
install.packages(cran[!cran %in% installed.packages()])
bioc. <- c("phyloseq",
"mixOmics",
NULL)
BiocManager::install(bioc.[!bioc. %in% installed.packages()])
cran <- c("ggplot2",
"ggpubr",
NULL)
install.packages(cran[!cran %in% installed.packages()])
bioc. <- c("phyloseq",
"mixOmics",
NULL)
BiocManager::install(bioc.[!bioc. %in% installed.packages()])
library(phyloseq)
library(mixOmics)
library(ggplot2)
library(ggpubr)
BiocManager::install(bioc.[!bioc. %in% installed.packages()], update = F)
library(phyloseq)
library(mixOmics)
library(ggplot2)
library(ggpubr)
ps <- readRDS(url("https://github.com/AMCMC/MiCA-Tutorials/raw/master/Data_files/ps.2018_27_RED_study.2019-03-04.filtered.RDS"))
ps@sam_data$Treatment <- ps@sam_data$Randomization
ps.paired<- rarefy_even_depth(ps, sample.size = 25000, rngseed = 21122, replace = F)
perm <- how(nperm = 999)
library(permute)
perm <- how(nperm = 999)
dist <- distance(ps.paired, "bray")
adonis2 (dist ~ Treatment, data = ps.paired@sam_data, permutations = perm)
library(vegan)
adonis2 (dist ~ Treatment, data = ps.paired@sam_data, permutations = perm)
adonis2 (dist ~ ps.paired@sam_data$Treatment, permutations = perm)
adonis2 (dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Treatment, permutations = perm)
adonis2 (dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = perm)
perm <- how(nperm = 999)
perm
perm$complete
perm$within
perm
perm$plots
as.matrix(perm)
ps.paired
ps.paired@sam_data$Subject_ID
table(ps.paired@sam_data$Subject_ID)
ps.paired <- prune_samples(ps.paired@sam_data$Subject_ID %in%  names(which(table(ps.paired@sam_data$Subject_ID)!=1)), ps.paired)
table(ps.paired@sam_data$Treatment, ps.paired@sam_data$Time_Point)
ps.paired
ps.paired <- prune_samples(ps.rare@sam_data$Subject_ID %in%  names(which(table(ps.rare@sam_data$Subject_ID)!=1)), ps.rare)
ps.rare<- rarefy_even_depth(ps, sample.size = 25000, rngseed = 21122, replace = F)
ps.paired <- prune_samples(ps.rare@sam_data$Subject_ID %in%  names(which(table(ps.rare@sam_data$Subject_ID)!=1)), ps.rare)
table(ps.paired@sam_data$Treatment, ps.paired@sam_data$Time_Point)
ps.paired
1:82
rep(1:82,100)
rbind(1:82)
rbind(1:82,1:82)
rbind(rbind(1:82),rbind(1:82,1:82))
rbind(rbind(1:82,1:82),rbind(1:82,1:82))
rbind(rbind(1:82,1:82),rbind(1:82,1:82:1:82))
rbind(rbind(1:82,1:82),rbind(1:82,1:82,1:82))
adonis2 (dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = rbind(rbind(1:82,1:82),rbind(1:82,1:82,1:82)))
adonis2(dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = rbind(rbind(1:82,1:82),rbind(1:82,1:82,1:82)))
dist <- distance(ps.paired, "bray")
perm <- how(nperm = 999)
adonis2 (dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = perm)
perm <- how(nperm = 999)
adonis2 (dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = perm)
dist <- distance(ps.paired, "bray")
perm <- how(nperm = 999)
adonis2 (dist ~ ps.paired@sam_data$Treatment, permutations = perm)
perm <- how(nperm = 999)
adonis2 (dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = perm)
setBlocks(perm) <- with(dat, field)
adonis2(dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = rbind(rbind(1:82,1:82),rbind(1:82,1:82,1:82)))
adonis2(dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = rbind(rbind(1:82,1:82),rbind(1:82,1:82,1:82)))
gl(ps.paired@sam_data$Treatment)
gl(2,20)
h1 <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = ps@sam_data$Subject_ID, type = "series"),
blocks = ps.paired@sam_data$Treatment)
adonis2(dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = h1)
h1 <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = ps.paired@sam_data$Subject_ID, type = "series"),
blocks = ps.paired@sam_data$Treatment)
adonis2(dist ~ ps.paired@sam_data$Treatment*ps.paired@sam_data$Time_Point, permutations = h1)
df <- ps.paired@sam_data
adonis2 (dist ~ Treatment, permutations = perm, data = df)
dist <- distance(ps.paired, "bray")
df <- ps.paired@sam_data
perm <- how(nperm = 999)
adonis2 (dist ~ Treatment, permutations = perm, data = df)
dist <- distance(ps.paired, "bray")
df <- data.frame(ps.paired@sam_data)
perm <- how(nperm = 999)
adonis2 (dist ~ Treatment, permutations = perm, data = df)
adonis2 (dist ~ Treatment*Time_Point, permutations = perm, data = df))
df$Time_Point
adonis2 (dist ~ Treatment*Time_Point, permutations = perm, data = df)
perm.strata <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = ps.paired@sam_data$Subject_ID, type = "series"),
blocks = ps.paired@sam_data$Treatment)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
knitr::opts_chunk$set(echo = TRUE)
cran <- c("ggplot2",
"ggpubr",
"vegan",
"permute",
NULL)
install.packages(cran[!cran %in% installed.packages()])
bioc. <- c("phyloseq",
"mixOmics",
NULL)
BiocManager::install(bioc.[!bioc. %in% installed.packages()], update = F)
library(phyloseq)
library(mixOmics)
library(ggplot2)
library(ggpubr)
library(permute)
library(vegan)
ps <- readRDS(url("https://github.com/AMCMC/MiCA-Tutorials/raw/master/Data_files/ps.2018_27_RED_study.2019-03-04.filtered.RDS"))
ps@sam_data$Treatment <- ps@sam_data$Randomization
ps.rare<- rarefy_even_depth(ps, sample.size = 25000, rngseed = 21122, replace = F)
ps.paired <- prune_samples(ps.rare@sam_data$Subject_ID %in%  names(which(table(ps.rare@sam_data$Subject_ID)!=1)), ps.rare)
table(ps.paired@sam_data$Treatment, ps.paired@sam_data$Time_Point)
vegdist("euclidian")
distance(ps.paired, "euclidian")
distance(ps.paired, type = "euclidian")
distance(ps.paired, method = "euclidian")
distance(ps.paired, method = "euclidean")
microbiome::transform(ps.paired, "clr")
dist <- distance(microbiome::transform(ps.paired, "clr"), method = "euclidean")
df <- data.frame(ps.paired@sam_data)
perm <- how(nperm = 999)
adonis2 (dist ~ Treatment, permutations = perm, data = df)
adonis2 (dist ~ Treatment*Time_Point, permutations = perm, data = df)
perm.strata <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = df$Subject_ID, type = "series"),
blocks = df$Treatment)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
dist <- distance(ps.paired, "wunifrac")
df <- data.frame(ps.paired@sam_data)
perm <- how(nperm = 999)
adonis2 (dist ~ Treatment, permutations = perm, data = df)
adonis2 (dist ~ Treatment*Time_Point, permutations = perm, data = df)
perm.strata <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = df$Subject_ID, type = "series"),
blocks = df$Treatment)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
dist <- distance(ps.paired, "unifrac")
#dist <- distance(microbiome::transform(ps.paired, "clr"), method = "euclidean")
df <- data.frame(ps.paired@sam_data)
perm <- how(nperm = 999)
adonis2 (dist ~ Treatment, permutations = perm, data = df)
adonis2 (dist ~ Treatment*Time_Point, permutations = perm, data = df)
perm.strata <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = df$Subject_ID, type = "series"),
blocks = df$Treatment)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
dist <- distance(ps.paired, "wunifrac")
#dist <- distance(microbiome::transform(ps.paired, "clr"), method = "euclidean")
df <- data.frame(ps.paired@sam_data)
perm <- how(nperm = 999)
adonis2 (dist ~ Treatment, permutations = perm, data = df)
adonis2 (dist ~ Treatment*Time_Point, permutations = perm, data = df)
perm.strata <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = df$Subject_ID, type = "series"),
blocks = df$Treatment)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
perm.strata <- how(within = Within(type = "series", mirror = TRUE),
plots = Plots(strata = df$Subject_ID, type = "series"),
blocks = df$Treatment)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment*Time_Point + Treatment + Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment:Time_Point + Treatment + Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment:Time_Point - Treatment - Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment:Time_Point - Treatment - Time_Point + Treatment, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment:Time_Point - Treatment - Time_Point + Treatment + Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment:Time_Point - Treatment - Time_Point + Treatment + Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment:Time_Point, permutations = perm.strata, data=df)
adonis2(dist ~ Treatment*Time_Point, permutations = perm.strata, data=df)
